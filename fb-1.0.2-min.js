var gorillaFB={app_cfg:{debug:false,picturePattern:window.location.protocol+"//graph.facebook.com/[id]/picture"},config:{appId:"",channel:"",status:true,cookie:true,xfbml:true,permissions:""},user:{initAuth:"",details:""},callbacks:{},debug:function(a){if(gorillaFB.app_cfg.debug&&(typeof console=="object")){console.log(a)}},isEmpty:function(a){for(var b in a){if(a.hasOwnProperty(b)){return false}}return true},hasPermission:function(b){var a=this;if(a.config.permissions.indexOf(b)>=0){return true}else{return false}},error:function(a){alert("[ERROR] "+a)},init:function(b){var a=this;gorillaFB.config=$.extend({},gorillaFB.config,b);window.fbAsyncInit=function(){FB.init({appId:a.config.appId,channelUrl:a.config.channel,status:a.config.status,cookie:a.config.cookie,xfbml:a.config.xfbml});FB.getLoginStatus(function(c){gorillaFB.user.initAuth=c;gorillaFB.debug(c);if(c.status==="connected"){a.getUserDetails()}else{if(c.status==="not_authorized"){gorillaFB.debug("User has not authentificated this application.")}else{gorillaFB.debug("User isnt logged in to Facebook.")}}if(a.callbacks.getLoginStatus!==undefined){a.callbacks.getLoginStatus(c)}gorillaFB.debug(gorillaFB)})}},login:function(){var a=this;FB.login(function(b){a.debug(b);if(b.authResponse){a.getUserDetails()}else{a.error("User cancelled login or did not fully authorize.")}if(a.callbacks.login!==undefined){a.callbacks.login(b)}return false},{scope:a.config.permissions})},getUserDetails:function(){var a=this;FB.api("/me",function(b){a.user.details=b;if(a.callbacks.apiMe!==undefined){a.callbacks.apiMe(b)}return b})},getPhoto:function(c){var a=this;if(c.id==undefined){c.id=a.user.details.id}var b=a.app_cfg.picturePattern.replace("[id]",c.id);if(c.type==undefined){b=b+"?width="+c.width+"&height="+c.height}else{switch(c.type){default:b=b+"?type=square";break;case"small":b=b+"?type=small";break;case"normal":b=b+"?type=normal";break;case"large":b=b+"?type=large";break}}return b},getFriends:function(c){var a=this;var b="/me/friends";if(c!==undefined&&c.limit!==undefined){b=b+"?limit="+c.limit}FB.api(b,function(d){if(c!==undefined&&c.callback!==undefined){c.callback(d)}})},getLikes:function(c){var a=this;if(a.hasPermission("user_likes")){var b="/me/likes";if(c!==undefined&&c.limit!==undefined){b=b+"?limit="+c.limit}FB.api(b,function(d){if(c!==undefined&&c.callback!==undefined){c.callback(d)}})}else{a.error("user_likes permission required to get user likes!")}},isFan:function(d){var a=this;if(a.hasPermission("user_likes")){var b="/me/likes";if(d!==undefined&&d.id!==undefined){b=b+"/"+d.id}var c=false;FB.api(b,function(e){if(e.data){if(!a.isEmpty(e.data)){c=true}}else{a.error("Unable to check if user liked page.")}if(d!==undefined&&d.assignTo!==undefined){window[d.assignTo]=c}if(d!==undefined&&d.callback!==undefined){d.callback(e)}})}},post:function(c){var b={method:"feed",name:"name",link:"picture",caption:"caption",description:"description"};var a=$.extend({},b,c);FB.ui(a,function(d){if(c!==undefined&&c.callback!==undefined){c.callback(d)}})},addPhoto:function(c){var a=this;if(c!==undefined&&c.albumID!==undefined){var b="/"+c.albumID+"/photos"}else{var b="/photos"}FB.api(b,"post",{message:c.description,url:c.url},function(d){if(!d||d.error){a.error("Error occured. Photo was not uploaded.")}if(c!==undefined&&c.callback!==undefined){c.callback(d)}})},query:function(b){var a=this;FB.api("fql",{q:b.query},function(c){if(b!==undefined&&b.callback!==undefined){b.callback(c)}})},usedByFriends:function(b){var a=this;a.query({query:"SELECT uid, name, is_app_user FROM user WHERE uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND is_app_user=1",callback:(b!==undefined&&b.callback!==undefined)?b.callback:function(){}})}};